<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.image.Image?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.effect.DropShadow?>
<?import javafx.scene.text.*?>
<?import javafx.scene.chart.*?>
<?import javafx.scene.shape.Circle?>

<ScrollPane fitToWidth="true" styleClass="transparent-scroll-pane" xmlns="http://javafx.com/javafx" xmlns:fx="http://javafx.com/fxml"
           fx:controller="org.cpi2.controllers.AccueilPageController" stylesheets="@/css/accueil.css">
    <VBox styleClass="welcome-container" alignment="TOP_CENTER">
        <!-- Header Section with Welcome Message -->
        <HBox styleClass="welcome-header" alignment="CENTER">
            <VBox alignment="CENTER" spacing="10">
                <Label text="Bienvenue dans votre Système de Gestion d'Auto-École" styleClass="welcome-title"/>
                <Label text="Votre outil complet pour gérer efficacement votre auto-école" styleClass="welcome-subtitle"/>
            </VBox>
        </HBox>
        
        <!-- Quick Statistics Cards -->
        <Label text="Aperçu Général" styleClass="section-title"/>
        <HBox styleClass="stats-container">
            <VBox styleClass="stat-card">
                <Text text="👥" styleClass="stat-icon"/>
                <Text fx:id="candidateCountText" text="0" styleClass="stat-value"/>
                <Label text="Candidats" styleClass="stat-label"/>
                <Button text="Voir tous les candidats" onAction="#loadAfficherCandidat" styleClass="action-button"/>
            </VBox>
            
            <VBox styleClass="stat-card">
                <Text text="🕒" styleClass="stat-icon"/>
                <Text fx:id="sessionCountText" text="0" styleClass="stat-value"/>
                <Label text="Séances" styleClass="stat-label"/>
                <Button text="Gérer les séances" onAction="#loadAfficherSeance" styleClass="action-button"/>
            </VBox>
            
            <VBox styleClass="stat-card">
                <Text text="👨‍🏫" styleClass="stat-icon"/>
                <Text fx:id="moniteurCountText" text="0" styleClass="stat-value"/>
                <Label text="Moniteurs" styleClass="stat-label"/>
                <Button text="Voir les moniteurs" onAction="#loadAfficherMoniteur" styleClass="action-button"/>
            </VBox>
        </HBox>
        
        <!-- Dashboard Cards -->
        <Label text="Tableau de Bord" styleClass="section-title"/>
        <HBox styleClass="dashboard-section">
            <VBox styleClass="dashboard-card">
                <HBox spacing="10" alignment="CENTER_LEFT">
                    <StackPane styleClass="dashboard-card-icon">
                        <Text text="💰" />
                    </StackPane>
                    <VBox spacing="17">
                        <Label text="Revenus ce mois" styleClass="dashboard-card-title"/>
                        <Text fx:id="monthlyIncomeText" text="---" styleClass="dashboard-card-value positive-value"/>
                        <Label fx:id="incomeComparisonLabel" text="Chargement..." styleClass="dashboard-card-subtitle"/>
                    </VBox>
                </HBox>
                <ProgressBar fx:id="incomeProgress" progress="0.75" styleClass="dashboard-card-progress" maxWidth="Infinity"/>
                <Button text="Voir finances" onAction="#loadDashboardFinance" styleClass="action-button"/>
            </VBox>
            
            <VBox styleClass="dashboard-card">
                <HBox spacing="10" alignment="CENTER_LEFT">
                    <StackPane styleClass="dashboard-card-icon">
                        <Text text="🏁" />
                    </StackPane>
                    <VBox spacing="17">
                        <Label text="Taux de réussite" styleClass="dashboard-card-title"/>
                        <Text fx:id="successRateText" text="---" styleClass="dashboard-card-value neutral-value"/>
                        <Label fx:id="successRateLabel" text="Chargement..." styleClass="dashboard-card-subtitle"/>
                    </VBox>
                </HBox>
                <ProgressBar fx:id="successProgress" progress="0.65" styleClass="dashboard-card-progress" maxWidth="Infinity"/>
                <Button text="Voir statistiques" onAction="#loadAfficherCandidat" styleClass="action-button"/>
            </VBox>
            
            <VBox styleClass="dashboard-card">
                <HBox spacing="10" alignment="CENTER_LEFT">
                    <StackPane styleClass="dashboard-card-icon">
                        <Text text="🚗" />
                    </StackPane>
                    <VBox spacing="4">
                        <Label text="Disponibilité véhicules" styleClass="dashboard-card-title"/>
                        <Text fx:id="vehiclesAvailableText" text="---" styleClass="dashboard-card-value"/>
                        <Label fx:id="vehicleStatusLabel" text="Chargement..." styleClass="dashboard-card-subtitle"/>
                    </VBox>
                </HBox>
                <ProgressBar fx:id="vehicleProgress" progress="0.85" styleClass="dashboard-card-progress" maxWidth="Infinity"/>
                <Button text="Gérer véhicules" onAction="#loadGestionVehicules" styleClass="action-button"/>
            </VBox>
        </HBox>
        
        <!-- Main Features Section -->
        <Label text="Fonctionnalités Principales" styleClass="section-title" alignment="CENTER"/>
        
        <GridPane styleClass="features-grid" alignment="CENTER" hgap="28" vgap="28">
            <columnConstraints>
                <ColumnConstraints percentWidth="33" halignment="CENTER"/>
                <ColumnConstraints percentWidth="33" halignment="CENTER"/>
                <ColumnConstraints percentWidth="33" halignment="CENTER"/>
            </columnConstraints>
            
            <!-- Row 1 - Green buttons -->
            <Button text="Inscription Candidat" onAction="#loadAjouterCandidat" styleClass="feature-button" 
                    GridPane.columnIndex="0" GridPane.rowIndex="0" maxWidth="280" prefWidth="280">
                <graphic>
                    <Text text="📝" style="-fx-font-size: 22px;"/>
                </graphic>
            </Button>
            
            <Button text="Planifier une Séance" onAction="#loadSessionConduite" styleClass="feature-button" 
                    GridPane.columnIndex="1" GridPane.rowIndex="0" maxWidth="280" prefWidth="280">
                <graphic>
                    <Text text="🚗" style="-fx-font-size: 22px;"/>
                </graphic>
            </Button>
            
            <Button text="Enregistrer Paiement" onAction="#loadPayment" styleClass="feature-button" 
                    GridPane.columnIndex="2" GridPane.rowIndex="0" maxWidth="280" prefWidth="280">
                <graphic>
                    <Text text="💰" style="-fx-font-size: 22px;"/>
                </graphic>
            </Button>
            
            <!-- Row 2 - Blue buttons -->
            <Button text="Gérer Véhicules" onAction="#loadGestionVehicules" styleClass="feature-button feature-button-alt" 
                    GridPane.columnIndex="0" GridPane.rowIndex="1" maxWidth="280" prefWidth="280">
                <graphic>
                    <Text text="🚙" style="-fx-font-size: 22px;"/>
                </graphic>
            </Button>
            
            <Button text="Inscription Examen" onAction="#loadExamRegistration" styleClass="feature-button feature-button-alt" 
                    GridPane.columnIndex="1" GridPane.rowIndex="1" maxWidth="280" prefWidth="280">
                <graphic>
                    <Text text="📅" style="-fx-font-size: 22px;"/>
                </graphic>
            </Button>
            
            <Button text="Tableau de Bord" onAction="#loadDashboardFinance" styleClass="feature-button feature-button-alt" 
                    GridPane.columnIndex="2" GridPane.rowIndex="1" maxWidth="280" prefWidth="280">
                <graphic>
                    <Text text="📊" style="-fx-font-size: 22px;"/>
                </graphic>
            </Button>
        </GridPane>
        
        <!-- Chart Section -->
        <Label text="Progression et Performance" styleClass="section-title"/>
        <VBox styleClass="chart-section">
            <VBox styleClass="chart-container">
                <Label text="Évolution des séances et inscriptions" styleClass="chart-title"/>
                <LineChart fx:id="progressionChart" legendVisible="true" animated="true" createSymbols="true" HBox.hgrow="ALWAYS" VBox.vgrow="ALWAYS">
                    <xAxis>
                        <CategoryAxis side="BOTTOM" />
                    </xAxis>
                    <yAxis>
                        <NumberAxis side="LEFT" />
                    </yAxis>
                </LineChart>
            </VBox>
        </VBox>
        
        <!-- Calendar and Notifications Section -->
        <Label text="Informations en Temps Réel" styleClass="section-title"/>
        
        <HBox styleClass="data-container">
            <!-- Upcoming Sessions -->
            <VBox styleClass="data-card" prefWidth="550" prefHeight="320" HBox.hgrow="ALWAYS">
                <Label text="Prochaines Séances" styleClass="data-card-title"/>
                <TableView fx:id="upcomingSessionsTable" styleClass="data-table" VBox.vgrow="ALWAYS">
                    <columns>
                        <TableColumn text="Date" fx:id="dateColumn" prefWidth="120"/>
                        <TableColumn text="Heure" fx:id="timeColumn" prefWidth="100"/>
                        <TableColumn text="Type" fx:id="typeColumn" prefWidth="110"/>
                        <TableColumn text="Candidats" fx:id="candidatesColumn" prefWidth="160"/>
                    </columns>
                    <placeholder>
                        <Label text="Aucune séance planifiée" styleClass="empty-text"/>
                    </placeholder>
                </TableView>
                <HBox alignment="CENTER_RIGHT" spacing="10">
                    <padding>
                        <Insets top="15" right="0" bottom="0" left="0"/>
                    </padding>
                    <Button text="Voir toutes les séances" onAction="#loadAfficherSeance" styleClass="action-button"/>
                </HBox>
            </VBox>
            
            <!-- Notifications -->
            <VBox styleClass="data-card" prefWidth="450" prefHeight="320" HBox.hgrow="ALWAYS">
                <Label text="Notifications Système" styleClass="data-card-title"/>
                <ListView fx:id="notificationsListView" styleClass="data-table" VBox.vgrow="ALWAYS">
                    <placeholder>
                        <Label text="Aucune notification" styleClass="empty-text"/>
                    </placeholder>
                </ListView>
                <HBox alignment="CENTER_RIGHT" spacing="10">
                    <padding>
                        <Insets top="15" right="0" bottom="0" left="0"/>
                    </padding>
                    <Button text="Centre de notifications" onAction="#loadAfficherNotifications" styleClass="action-button"/>
                </HBox>
            </VBox>
        </HBox>
        
        <!-- Auto-École Information -->
        <VBox styleClass="info-section">
            <Label text="Informations sur l'Auto-École" styleClass="info-title"/>
            
            <HBox styleClass="info-container">
                <VBox styleClass="info-group" HBox.hgrow="ALWAYS">
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="Nom:" styleClass="info-label"/>
                        <Label fx:id="schoolNameLabel" text="" styleClass="info-value" HBox.hgrow="ALWAYS"/>
                    </HBox>
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="Adresse:" styleClass="info-label"/>
                        <Label fx:id="schoolAddressLabel" text="" styleClass="info-value" HBox.hgrow="ALWAYS"/>
                    </HBox>
                </VBox>
                
                <VBox styleClass="info-group" HBox.hgrow="ALWAYS">
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="Téléphone:" styleClass="info-label"/>
                        <Label fx:id="schoolPhoneLabel" text="" styleClass="info-value" HBox.hgrow="ALWAYS"/>
                    </HBox>
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="Email:" styleClass="info-label"/>
                        <Label fx:id="schoolEmailLabel" text="" styleClass="info-value" HBox.hgrow="ALWAYS"/>
                    </HBox>
                </VBox>
            </HBox>
            
            <HBox alignment="CENTER">
                <Button text="Gérer mon Auto-École" onAction="#loadAutoEcoleManagement" styleClass="manage-button"/>
            </HBox>
        </VBox>
    </VBox>
</ScrollPane> 