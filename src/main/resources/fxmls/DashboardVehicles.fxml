<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.chart.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.geometry.Insets?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="org.cpi2.controllers.DashboardVehicles"
            stylesheets="@/css/style.css"
            styleClass="root">

    <padding>
        <Insets top="20" right="20" bottom="20" left="20"/>
    </padding>

    <top>
        <VBox alignment="CENTER" spacing="10">
            <Label text="Tableau de Bord des Véhicules" styleClass="dashboard-title"/>
            <HBox alignment="CENTER" spacing="15" styleClass="period-selector">
                <Label text="Filtrer par:" styleClass="form-label"/>
                <ComboBox fx:id="filterCombo" promptText="Tous les véhicules" styleClass="form-field"/>
                <Button text="Appliquer" onAction="#handleApplyFilter" styleClass="button, submit-button"/>
            </HBox>
        </VBox>
    </top>

    <center>
        <ScrollPane fitToWidth="true" styleClass="transparent-scroll-pane">
            <VBox spacing="20">
                <!-- KPI Cards Row -->
                <HBox spacing="15" alignment="CENTER">
                    <VBox.margin>
                        <Insets top="10" bottom="10"/>
                    </VBox.margin>
                    
                    <!-- Total Vehicles Card -->
                    <VBox styleClass="dashboard-card" HBox.hgrow="ALWAYS">
                        <Label text="Total des Véhicules" styleClass="card-title"/>
                        <Label fx:id="totalVehiclesLabel" text="12" styleClass="card-value"/>
                    </VBox>
                    
                    <!-- Available Vehicles Card -->
                    <VBox styleClass="dashboard-card" HBox.hgrow="ALWAYS">
                        <Label text="Véhicules Disponibles" styleClass="card-title"/>
                        <Label fx:id="availableVehiclesLabel" text="8" styleClass="card-value"/>
                    </VBox>
                    
                    <!-- Maintenance Due Card -->
                    <VBox styleClass="dashboard-card" HBox.hgrow="ALWAYS">
                        <Label text="Entretiens à Faire" styleClass="card-title"/>
                        <Label fx:id="maintenanceDueLabel" text="3" styleClass="card-value"/>
                    </VBox>
                    
                    <!-- Total KM Card -->
                    <VBox styleClass="dashboard-card" HBox.hgrow="ALWAYS">
                        <Label text="Kilométrage Total" styleClass="card-title"/>
                        <Label fx:id="totalKmLabel" text="157,340 km" styleClass="card-value"/>
                    </VBox>
                </HBox>
                
                <!-- Charts Row 1 -->
                <HBox spacing="15" alignment="CENTER" VBox.vgrow="ALWAYS">
                    <!-- Vehicle Usage Chart -->
                    <VBox styleClass="chart-container" HBox.hgrow="ALWAYS">
                        <Label text="Utilisation des Véhicules" styleClass="chart-title"/>
                        <PieChart fx:id="vehicleUsageChart" animated="true" labelsVisible="true" VBox.vgrow="ALWAYS"/>
                    </VBox>
                    
                    <!-- Maintenance History -->
                    <VBox styleClass="chart-container" HBox.hgrow="ALWAYS">
                        <Label text="Historique des Entretiens" styleClass="chart-title"/>
                        <BarChart fx:id="maintenanceHistoryChart" legendVisible="false" animated="true" VBox.vgrow="ALWAYS">
                            <xAxis>
                                <CategoryAxis fx:id="maintenanceMonthAxis" label="Mois"/>
                            </xAxis>
                            <yAxis>
                                <NumberAxis fx:id="maintenanceCountAxis" label="Nombre d'entretiens"/>
                            </yAxis>
                        </BarChart>
                    </VBox>
                </HBox>
                
                <!-- Vehicle Table -->
                <VBox styleClass="table-container" VBox.vgrow="ALWAYS">
                    <Label text="État des Véhicules" styleClass="table-title"/>
                    <TableView fx:id="vehiclesTable" VBox.vgrow="ALWAYS" styleClass="custom-table-view">
                        <columns>
                            <TableColumn fx:id="vehicleIdColumn" text="ID" prefWidth="60"/>
                            <TableColumn fx:id="vehicleModelColumn" text="Modèle" prefWidth="150"/>
                            <TableColumn fx:id="vehiclePlateColumn" text="Immatriculation" prefWidth="120"/>
                            <TableColumn fx:id="vehicleKmColumn" text="Kilométrage" prefWidth="100"/>
                            <TableColumn fx:id="vehicleStatusColumn" text="Statut" prefWidth="100"/>
                            <TableColumn fx:id="vehicleLastMaintenanceColumn" text="Dernier Entretien" prefWidth="120"/>
                            <TableColumn fx:id="vehicleNextMaintenanceColumn" text="Prochain Entretien" prefWidth="120"/>
                        </columns>
                    </TableView>
                </VBox>
                
                <!-- Maintenance Alerts -->
                <VBox styleClass="table-container" VBox.vgrow="ALWAYS">
                    <Label text="Alertes d'Entretien" styleClass="table-title"/>
                    <TableView fx:id="maintenanceAlertsTable" VBox.vgrow="ALWAYS" styleClass="custom-table-view">
                        <columns>
                            <TableColumn fx:id="alertVehicleColumn" text="Véhicule" prefWidth="150"/>
                            <TableColumn fx:id="alertTypeColumn" text="Type" prefWidth="120"/>
                            <TableColumn fx:id="alertDueDateColumn" text="Date Prévue" prefWidth="120"/>
                            <TableColumn fx:id="alertStatusColumn" text="Statut" prefWidth="100"/>
                            <TableColumn fx:id="alertPriorityColumn" text="Priorité" prefWidth="80"/>
                            <TableColumn fx:id="alertActionsColumn" text="Actions" prefWidth="120"/>
                        </columns>
                    </TableView>
                </VBox>
            </VBox>
        </ScrollPane>
    </center>
</BorderPane> 